# 醫療資料頁面監測工具

## 簡介

醫療資料頁面監測工具是基於原始醫療資料擷取工具開發的進階版本，專門用於監測特定醫療資訊系統頁面的變化。當頁面被刷新且檢測到新資料時，工具會自動執行資料擷取動作。

## 主要功能

- **頁面變化監測**：持續監測指定網址的頁面變化
- **自動資料檢測**：當頁面刷新後自動檢測是否有新資料
- **智能觸發機制**：僅在檢測到資料變化時執行擷取動作
- **背景運行**：在背景持續監測，不影響正常瀏覽
- **資料比較**：比較前後資料差異，避免重複處理

## 目標網址

本工具專門針對以下網址進行監測：
- https://medcloud2.nhi.gov.tw/imu/IMUE1000/IMUE0008

## 工作原理

1. **頁面監聽**：監聽目標頁面的 DOM 變化和頁面重新載入事件
2. **資料快照**：定期保存頁面資料的快照
3. **變化檢測**：比較新舊資料快照，識別變化
4. **自動觸發**：當檢測到新資料時，自動執行擷取和處理動作
5. **結果通知**：通過瀏覽器通知或彈窗告知用戶處理結果

## 安裝方法

1. 下載擴充功能檔案
2. 解壓縮到本地資料夾
3. 在 Edge 瀏覽器中開啟擴充功能管理頁面
4. 開啟「開發人員模式」
5. 點擊「載入解壓縮的擴充功能」
6. 選擇解壓縮後的資料夾
7. 安裝完成後，擴充功能會自動開始監測

## 使用方法

1. 安裝擴充功能後，瀏覽至目標網址
2. 擴充功能會自動開始監測頁面變化
3. 當頁面被刷新且有新資料時，工具會自動執行擷取
4. 可透過擴充功能圖示查看監測狀態和結果

## 設定選項

### 監測設定
- **監測間隔**：設定檢查頁面變化的時間間隔
- **敏感度**：設定觸發資料擷取的變化閾值
- **目標元素**：指定要監測的頁面元素

### 通知設定
- **變化通知**：當檢測到頁面變化時顯示通知
- **擷取完成通知**：資料擷取完成後顯示結果通知
- **錯誤通知**：發生錯誤時顯示警告通知

### 資料處理設定
- **自動儲存**：自動儲存擷取的資料
- **儲存格式**：設定資料的儲存格式（CSV/JSON/Excel）
- **檔案命名**：設定自動儲存檔案的命名規則

## 技術特點

- **非侵入式監測**：不會主動刷新頁面，僅被動監測變化
- **高效能**：使用 MutationObserver API 進行高效的 DOM 監測
- **智能過濾**：過濾無關的頁面變化，僅關注資料變化
- **錯誤恢復**：具備錯誤處理和自動恢復機制

## 版本資訊

- 版本：2.0.0
- 基於：醫療資料一鍵擷取工具 v1.0.0
- 最後更新：2025-06-03
- 開發目標：監測 https://medcloud2.nhi.gov.tw/imu/IMUE1000/IMUE0008

## 隱私聲明

本工具繼承原版本的隱私保護特性，所有資料處理均在本地完成，不會上傳或儲存您的醫療資料到外部伺服器。監測和擷取的資料僅儲存在您的裝置上。

